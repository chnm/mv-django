{% load wagtailimages_tags %}

<div class="image-gallery my-8">
    {% if value.title %}
        <h3 class="text-xl font-display font-semibold text-black mb-4">{{ value.title }}</h3>
    {% endif %}

    {% if value.images %}
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {% for image_item in value.images %}
                <div class="gallery-item cursor-pointer group">
                    {% image image_item.image fill-300x200 as thumbnail %}
                    {% image image_item.image width-1200 as full_image %}

                    <div class="relative overflow-hidden rounded-lg shadow-amalfi transition-transform duration-200 group-hover:scale-105 h-32 bg-white-200 border border-lavender-200"
                         onclick="openGalleryLightbox('{{ full_image.url }}', '{{ image_item.caption|safe|escapejs }}')"
                         data-full-image="{{ full_image.url }}"
                         data-caption="{{ image_item.caption|safe|escapejs }}">
                        <img src="{{ thumbnail.url }}"
                             alt="{{ image_item.caption|striptags|default:'Gallery image' }}"
                             class="w-full h-full object-cover block"
                             style="display: block; margin: 0; padding: 0; vertical-align: top;">
                        <div class="absolute inset-0 bg-mediterranean-800 bg-opacity-0 group-hover:bg-opacity-20 transition-opacity duration-200 flex items-center justify-center">
                            <svg class="w-8 h-8 text-white-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path>
                            </svg>
                        </div>
                    </div>

                    {% if image_item.caption %}
                        <div class="mt-2 text-sm text-black leading-tight">
                            {{ image_item.caption|safe }}
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
